Repository: ProgettoGestionaleBRT
Generated: 2025-10-06

Scope: frontend/src (aggiornato alla struttura domain-driven attuale)

Root src/
- app/ : Layouts e provider globali (Auth, Theme, ecc.)
- assets/ : Immagini e risorse statiche (LogoBRT.png, LogoGestionale.png, react.svg ...)
- config/ : Configurazioni (es. flag debug o mapping costanti)
- domains/ : Feature domains (bounded contexts)
- Hooks/ : (Residual generic hooks – migrazione in domains in corso)
- Pages/ : Pagine legacy / non ancora migrate in domains
- Routes/ : Configurazione di routing
- mocks/ : Dati mock + MSW handlers
- shared/ : Componenti / util condivisi cross-domain
- App.jsx / main.jsx : bootstrap applicazione

domains/
  accordi-quadro/
  auth/
  commesse/
  gare/
  tags/
  timesheet/  (dominio migrato principale)

domains/timesheet/
  components/
    admin-grid/ (componenti amministrazione futura – placeholder / da validare)
    calendar/
      DayEntryDialog.jsx
      DayEntryPanel.jsx
      DayEntryTile.jsx
      EmployeeMonthGrid.jsx
      formatDayTooltip.jsx
      index.js (barrel export)
      MonthSelector.jsx
      ProjectSidePanel.jsx
      statusConstants.js
      statusIcons.jsx
      statusIcons.utils.js
      TaskDetailCard.jsx
      utils/
        dateUtils.js
        dayStatus.js
        index.js
        monthNames.js
        tileStyles.js
      WorkCalendar.jsx
      WorkCalendarGrid.jsx
    panels/  (placeholder per pannelli futuri – attualmente vuoto o minimale)
    staging/
      AggregationTable.jsx (selezioni / aggregazioni – basico)
      LegendItem.jsx
      OperaioEditor.jsx (editor specifico / placeholder)
      StagedChangesPanel.jsx (pannello modifiche – versione estesa con overflow & snackbar)
      TimesheetStagingBar.jsx (wrapper Paper + props)
      index.js (barrel)
  hooks/
    calendar/ (hook derivati calendario – stato giorni, metadata)
    dayEntry/ (gestione editing singolo giorno)
    staging/
      index.js
      stagingReducer.js
      TimesheetStagingContext.jsx (provider + context)
      useStagedMetaMap.js
      useStagingContextHooks.js (optional getters context-safe)
      useTimesheetStaging.js (facade azioni: upsert, rollback, confirmAll ...)
    utils/
      computeDayUsed.js
      roleCapabilities.js (implementazione minimale post-refactor)
      semanticTimesheet.js
      timesheetModel.js (diff & summarization helpers)
    validation/
      (validator hooks / funzioni – se vuoto ora, previsto per estensioni)
    README.md (linee guida dominio timesheet)
    TimesheetProvider.jsx (provider principale domain-scope)
    useDayAndMonthDetails.js
    useDayEditor.js
    useEmployeeMonthGridRows.js
    useEmployeeTimesheetLoader.js
    useMonthCompleteness.js (versione semplificata: { filled, working, ratio })
    useReferenceData.js
    useSegnalazione.js (stub / estensione futura)
    useStableMergedDataMap.js (merge base + staging)
    useTimesheetApi.js (integrazione API futura / stub)
    useTimesheetData.js (aggregazione dati principale)
    useTimesheetFilters.js
  models/ (modelli e shape – definizioni dati centralizzate se/quando aggiunte)
  pages/
    CoordinatoreTimesheet.jsx (pagina coordinatore – in evoluzione)
    DipendenteTimesheet.jsx (pagina dipendente – usa provider + staging bar)
    TimesheetRouter.jsx (route boundary del dominio timesheet)
    index.js (barrel pages)
  services/ (future integrazioni remote specifiche dominio – stub al momento)

shared/ : util e componenti cross-domain (non dettagliati qui – mantenere DRY e isolare ciò che diventa domain-specific spostandolo)

Hooks/ : contiene ancora alcuni hook generici; progressivamente da spostare sotto domains appropriati.

UTILS PRINCIPALI (dominio timesheet)
- timesheetModel.js : computeDayDiff / summarizeDayDiff / helpers diff entries
- semanticTimesheet.js : hashing / semantic identity
- computeDayUsed.js : calcolo ore utilizzate da una giornata
- roleCapabilities.js : mappa capacità ruoli (placeholder – raffinabile)

STAGING CORE
- stagingReducer.js : struttura stato { entries, order }
- useTimesheetStaging.js : facade semplificato per componenti UI
- StagedChangesPanel.jsx : visualizzazione diff & azioni bulk/overflow
- useStableMergedDataMap.js : merge base + draft/staging

NOTE MIGRAZIONE
- Vecchia struttura `src/Hooks/Timesheet/*` rimossa; tutti i riferimenti aggiornati.
- Avvisi sul mese precedente (missing days) disabilitati fino a reintroduzione hook esteso.
- `roleCapabilities` implementato in forma minimale: definire regole effettive prima di usarlo per autorizzazioni reali.
- `StagedChangesPanel` ora espone props: compact, maxVisible, showLegend, enableOverflow, showActions.

PROSSIMI POSSIBILI PASSI
- Aggiungere test unitari (Vitest) per diff utils e staging reducer.
- Reintrodurre calcolo giorni mancanti mese precedente (hook esteso).
- Consolidare hook generici spostandoli in domains/ pertinenti.
- Validare e riempire folder `panels/` o rimuoverlo se non necessario.

